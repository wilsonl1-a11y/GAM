<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Users - Gmail - Messages/Threads - GAM Docs</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">GAM Docs</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href=".." class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../00scratch/" class="nav-link">Scratch Me Wiki</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Addresses/" class="nav-link">Addresses</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Administrators/" class="nav-link">Administrators</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Alert-Center/" class="nav-link">Alert Center</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Aliases/" class="nav-link">Aliases</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Authorization/" class="nav-link">Authorization</a>
                            </li>
                            <li class="nav-item">
                                <a href="../BNF-Syntax/" class="nav-link">Syntax</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Basic-Items/" class="nav-link">Basic Items</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Bulk-Processing/" class="nav-link">Bulk Processing</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Business-Account-Management/" class="nav-link">Users - Business Account Management</a>
                            </li>
                            <li class="nav-item">
                                <a href="../CSV-Input-Filtering/" class="nav-link">CSV Input Filtering</a>
                            </li>
                            <li class="nav-item">
                                <a href="../CSV-Output-Filtering/" class="nav-link">CSV Output Filtering</a>
                            </li>
                            <li class="nav-item">
                                <a href="../CSV-Special-Characters/" class="nav-link">CSV Special Characters</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Calendars-Access/" class="nav-link">Calendars - Access</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Calendars-Events/" class="nav-link">Calendars - Events</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Calendars/" class="nav-link">Calendars</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Chat-Bot-Setup-Use/" class="nav-link">Chat Bot Setup and Use</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Chrome-AUE-Counts/" class="nav-link">Chrome Auto Update Expiration Counts</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Chrome-Browser-Cloud-Management/" class="nav-link">Chrome Browser Cloud Management</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Chrome-Device-Counts/" class="nav-link">Chrome Device Counts</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Chrome-Installed-Apps/" class="nav-link">Chrome Installed Apps</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Chrome-Needs-Attention-Counts/" class="nav-link">Chrome Device Needs Attention Counts</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Chrome-Policies/" class="nav-link">Chrome Policies</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Chrome-Printers/" class="nav-link">Chrome Printers</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Chrome-Profile-Management/" class="nav-link">Chrome Profile Management</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Chrome-Version-Counts/" class="nav-link">Chrome Version Counts</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Chrome-Version-History/" class="nav-link">Chrome Version History</a>
                            </li>
                            <li class="nav-item">
                                <a href="../ChromeOS-Devices/" class="nav-link">ChromeOS Devices</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Classroom-Courses/" class="nav-link">Classroom - Courses</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Classroom-Guardians/" class="nav-link">Classroom - Guardians</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Classroom-Invitations/" class="nav-link">Classroom - Invitations</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Classroom-Membership/" class="nav-link">Classroom - Membership</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Classroom-StudentGroups/" class="nav-link">Classroom - Student Groups</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Cloud-Channel/" class="nav-link">Cloud Channel</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Cloud-Identity-Devices/" class="nav-link">Cloud Identity Devices</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Cloud-Identity-Groups-Membership/" class="nav-link">Cloud Identity Groups - Membership</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Cloud-Identity-Groups/" class="nav-link">Cloud Identity Groups</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Cloud-Identity-Policies/" class="nav-link">Cloud Identity Policies</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Cloud-Storage/" class="nav-link">Cloud Storage</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Collections-of-ChromeOS-Devices/" class="nav-link">Collections of ChromeOS Devices</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Collections-of-Items/" class="nav-link">Collections of Items</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Collections-of-Users/" class="nav-link">Collections of Users</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Command-Data-From-Google-Docs-Sheets-Storage/" class="nav-link">Command data from Google Docs, Sheets and Cloud Storage</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Command-Line-Parsing/" class="nav-link">Command Line Parsing</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Command-Logging-Progress/" class="nav-link">Command Logging and Progress</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Context-Aware-Access-Levels/" class="nav-link">Context-Aware Access Levels</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Customer/" class="nav-link">Customer</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Domain-People-Contacts-Profiles/" class="nav-link">Domain People - Contacts &amp; Profiles</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Domain-SharedContacts/" class="nav-link">Domain Shared Contacts</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Domains-Verification/" class="nav-link">Domains - Verification</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Domains/" class="nav-link">Domains</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Downloads-Installs/" class="nav-link">Downloads-Installs-GAM7</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Drive-File-Selection/" class="nav-link">Drive File Selection</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Drive-Items/" class="nav-link">Drive Items</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Drive-REST-API-v3/" class="nav-link">Drive REST API v3</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Email-Audit-Monitor/" class="nav-link">Email Audit Monitor</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Find-File-Owner/" class="nav-link">Find File Owner</a>
                            </li>
                            <li class="nav-item">
                                <a href="../GAM-Public-Chat-Room/" class="nav-link">GAM Public Chat Room</a>
                            </li>
                            <li class="nav-item">
                                <a href="../GAM-Release-Process/" class="nav-link">Steps to release a new GAM version</a>
                            </li>
                            <li class="nav-item">
                                <a href="../GAM-Return-Codes/" class="nav-link">GAM Return Codes</a>
                            </li>
                            <li class="nav-item">
                                <a href="../GAM-with-minimal-GCP-rights/" class="nav-link">GAM setup with minimal GCP permissions.</a>
                            </li>
                            <li class="nav-item">
                                <a href="../GAM7-FAQ/" class="nav-link">What is GAM7?</a>
                            </li>
                            <li class="nav-item">
                                <a href="../GAM7-on-Android-Devices/" class="nav-link">GAM7 on Android Devices</a>
                            </li>
                            <li class="nav-item">
                                <a href="../GAM7-on-Chrome-OS-Devices/" class="nav-link">GAM7 on Chrome OS Devices</a>
                            </li>
                            <li class="nav-item">
                                <a href="../GamUpdates/" class="nav-link">Update GAM7 to latest version</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Global-Address-List/" class="nav-link">Global Address List</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Google-Data-Transfers/" class="nav-link">Google Data Transfers</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Google-Network-Addresses/" class="nav-link">Google Network Addresses</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Groups-Membership/" class="nav-link">Groups Membership</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Groups/" class="nav-link">Groups</a>
                            </li>
                            <li class="nav-item">
                                <a href="../HTTPS-Proxy/" class="nav-link">HTTPS Proxy</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Home/" class="nav-link">Introduction</a>
                            </li>
                            <li class="nav-item">
                                <a href="../How-to-Install-GAM7/" class="nav-link">Installing GAM7</a>
                            </li>
                            <li class="nav-item">
                                <a href="../How-to-Uninstall-GAM7/" class="nav-link">Uninstalling GAM7</a>
                            </li>
                            <li class="nav-item">
                                <a href="../How-to-Update-GAM7/" class="nav-link">Updating GAM7</a>
                            </li>
                            <li class="nav-item">
                                <a href="../How-to-Upgrade-GAMADV-XTD3-to-GAM7/" class="nav-link">Installation - Upgrade GAMADV-XTD3 to GAM7</a>
                            </li>
                            <li class="nav-item">
                                <a href="../How-to-Upgrade-Legacy-GAM-to-GAM7/" class="nav-link">Installation - Upgrade Legacy GAM to GAM7</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Inbound-SSO/" class="nav-link">Inbound SSO</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Install-GAM-as-Python-Library/" class="nav-link">Install GAM as Python Library</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Licenses/" class="nav-link">Licenses</a>
                            </li>
                            <li class="nav-item">
                                <a href="../List-Items/" class="nav-link">List Items</a>
                            </li>
                            <li class="nav-item">
                                <a href="../List/" class="nav-link">List</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Meta-Commands-and-File-Redirection/" class="nav-link">Meta Commands and File Redirection</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Mobile-Devices/" class="nav-link">Mobile Devices</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Organizational-Units/" class="nav-link">Organizational Units</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Other-Resources/" class="nav-link">Other Resources</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Permission-Matches/" class="nav-link">Permission Matches</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Python-Regular-Expressions/" class="nav-link">Python Regular Expressions</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Rclone/" class="nav-link">Rclone</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Reports/" class="nav-link">Reports</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Reseller/" class="nav-link">Reseller</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Resources/" class="nav-link">Resources</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Running-GAM7-securely-on-a-Google-Compute-Engine/" class="nav-link">Running GAM7 securely on a Google Compute Engine</a>
                            </li>
                            <li class="nav-item">
                                <a href="../SSL-Root-CA-Certificates/" class="nav-link">SSL Root CA Certificates</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Schemas/" class="nav-link">Schemas</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Scripts/" class="nav-link">Scripts</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Send-Email/" class="nav-link">Send Email</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Shared-Drives/" class="nav-link">Domain Administrators - Shared Drives</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Sites/" class="nav-link">Sites</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Tag-Replace/" class="nav-link">Tag Replace</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Todrive/" class="nav-link">Todrive</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Unmanaged-Accounts/" class="nav-link">Unmanaged Accounts</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Upgrade-Benefits/" class="nav-link">Upgrade Benefits</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Analytics-Admin/" class="nav-link">Users - Analytics Admin</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Application-Specific-Passwords/" class="nav-link">Users - Application Specific Passwords</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Backup-Verification-Codes/" class="nav-link">Users - Backup Verification Codes</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Calendars-Access/" class="nav-link">Users - Calendars - Access</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Calendars-Events/" class="nav-link">Users - Calendars - Events</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Calendars/" class="nav-link">Users - Calendars</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Chat/" class="nav-link">Users - Chat</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Classification-Labels/" class="nav-link">Users - Classification Labels</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Classroom-Profile/" class="nav-link">Users - Classroom - Profile</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Contacts-Delegates/" class="nav-link">Users - Contacts - Delegates</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Contacts/" class="nav-link">User Contacts</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Deprovision/" class="nav-link">Users - Deprovision</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Drive-Activity-Settings/" class="nav-link">Users - Drive - Activity/Settings</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Drive-Cleanup/" class="nav-link">Users - Drive - Cleanup</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Drive-Comments/" class="nav-link">Users - Drive - Comments</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Drive-Copy-Move/" class="nav-link">Users - Drive Files Copy/Move</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Drive-Files-Display/" class="nav-link">Users - Drive Files Display</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Drive-Files-Manage/" class="nav-link">Users - Drive Files Manage</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Drive-Orphans/" class="nav-link">Users - Drive - Orphans</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Drive-Ownership/" class="nav-link">Users - Drive - Ownership</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Drive-Permissions/" class="nav-link">Users - Drive - Permissions</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Drive-Query/" class="nav-link">Users - Drive - Query</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Drive-Revisions/" class="nav-link">Users - Drive - Revisions</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Drive-Shortcuts/" class="nav-link">Users - Drive Shortcuts</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Drive-Transfer/" class="nav-link">Users - Drive - Transfer</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Forms/" class="nav-link">Users - Forms</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Gmail-CSE/" class="nav-link">Users - Gmail - Client Side Encryption</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Gmail-Delegates/" class="nav-link">Users - Gmail - Delegates</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Gmail-Filters/" class="nav-link">Users - Gmail - Filters</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Gmail-Forwarding/" class="nav-link">Users - Gmail - Forwarding</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Gmail-Labels/" class="nav-link">Users - Gmail - Labels</a>
                            </li>
                            <li class="nav-item">
                                <a href="./" class="nav-link active" aria-current="page">Users - Gmail - Messages/Threads</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Gmail-Profile/" class="nav-link">Users - Gmail - Profile</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Gmail-S-MIME/" class="nav-link">Users - Gmail - S/MIME</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Gmail-Send-As-Signature-Vacation/" class="nav-link">Users - Gmail - Send As/Signature/Vacation</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Gmail-Settings/" class="nav-link">Users - Gmail - Settings</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Group-Membership/" class="nav-link">Users - Group Membership</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Keep-Notes/" class="nav-link">Users - Keep - Notes</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Looker-Studio/" class="nav-link">Users - Looker Studio</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Meet/" class="nav-link">Users - Meet</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-People-Contacts-Profiles/" class="nav-link">Users - People - Contacts &amp; Profiles</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Photo/" class="nav-link">Users - Photo</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Profile-Photo/" class="nav-link">Users - Profile Photo</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Profile-Sharing/" class="nav-link">Users - Profile Sharing</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Shared-Drives/" class="nav-link">Users - Shared Drives</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Signout-Turnoff2SV/" class="nav-link">Users - Signout and Turn off 2-Step Verification</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Spreadsheets/" class="nav-link">Users - Spreadsheets</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Tag-Manager/" class="nav-link">Users - Tag Manager</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Tasks/" class="nav-link">Users - Tasks</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Tokens/" class="nav-link">Users - Tokens</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-Web-Resources-and-Sites/" class="nav-link">Users - Web Resources and Sites</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users-YouTube/" class="nav-link">Users - YouTube</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Users/" class="nav-link">Users</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Using-GAM7-with-a-YubiKey/" class="nav-link">Using GAM7 with a YubiKey</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Using-GAM7-with-a-delegated-admin-service-account/" class="nav-link">Using GAM7 with a delegated admin service account</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Using-GAM7-with-keyless-authentication-Workload-Identity-Federation/" class="nav-link">Using GAM7 with Keyless Authentication - Workload Identity Federation</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Vault-Takeout/" class="nav-link">Vault - Takeout</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Verifying-a-GAM7-Build-is-Legitimate-and-Official/" class="nav-link">Verifying a GAM7 Build is Legitimate and Official</a>
                            </li>
                            <li class="nav-item">
                                <a href="../Version-and-Help/" class="nav-link">Version and Help</a>
                            </li>
                            <li class="nav-item">
                                <a href="../_Sidebar/" class="nav-link"> Sidebar</a>
                            </li>
                            <li class="nav-item">
                                <a href="../gam.cfg/" class="nav-link">GAM Configuration</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Legacy</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../legacy/l-AdminSettingsExamples/" class="dropdown-item">l AdminSettingsExamples</a>
</li>
                                    
<li>
    <a href="../legacy/l-Android-Installation/" class="dropdown-item">l Android Installation</a>
</li>
                                    
<li>
    <a href="../legacy/l-BulkOperations/" class="dropdown-item">l BulkOperations</a>
</li>
                                    
<li>
    <a href="../legacy/l-CalendarExamples/" class="dropdown-item">l CalendarExamples</a>
</li>
                                    
<li>
    <a href="../legacy/l-Chat-Bot/" class="dropdown-item">l Chat Bot</a>
</li>
                                    
<li>
    <a href="../legacy/l-Chrome-Browser-Management/" class="dropdown-item">l Chrome Browser Management</a>
</li>
                                    
<li>
    <a href="../legacy/l-Chrome-OS-Installation/" class="dropdown-item">l Chrome OS Installation</a>
</li>
                                    
<li>
    <a href="../legacy/l-Chrome-Policy-Settings/" class="dropdown-item">l Chrome Policy Settings</a>
</li>
                                    
<li>
    <a href="../legacy/l-Cloud-Identity-Groups/" class="dropdown-item">l Cloud Identity Groups</a>
</li>
                                    
<li>
    <a href="../legacy/l-Command-Reference-Calendar-Resources/" class="dropdown-item">GAM Calendar Resources Command Reference</a>
</li>
                                    
<li>
    <a href="../legacy/l-Command-Reference-Calendars/" class="dropdown-item">GAM Calendar Command Reference</a>
</li>
                                    
<li>
    <a href="../legacy/l-Command-Reference-Definitions/" class="dropdown-item">l Command Reference Definitions</a>
</li>
                                    
<li>
    <a href="../legacy/l-Command-Reference-Drive/" class="dropdown-item">GAM Drive Command Reference</a>
</li>
                                    
<li>
    <a href="../legacy/l-Command-Reference-Email/" class="dropdown-item">GAM Email Command Reference</a>
</li>
                                    
<li>
    <a href="../legacy/l-Command-Reference-Group-Attributes/" class="dropdown-item">GAM Group Attributes Command Reference</a>
</li>
                                    
<li>
    <a href="../legacy/l-Command-Reference-Groups/" class="dropdown-item">GAM Group Command Reference</a>
</li>
                                    
<li>
    <a href="../legacy/l-Command-Reference-Users/" class="dropdown-item">GAM Users Command Reference</a>
</li>
                                    
<li>
    <a href="../legacy/l-Context-Aware-Access-Levels/" class="dropdown-item">l Context Aware Access Levels</a>
</li>
                                    
<li>
    <a href="../legacy/l-Creating-client_secrets.json-and-oauth2service.json/" class="dropdown-item">l Creating client secrets.json and oauth2service.json</a>
</li>
                                    
<li>
    <a href="../legacy/l-CreatingClientSecretsFile/" class="dropdown-item">l CreatingClientSecretsFile</a>
</li>
                                    
<li>
    <a href="../legacy/l-Custom-Schemas/" class="dropdown-item">l Custom Schemas</a>
</li>
                                    
<li>
    <a href="../legacy/l-Data-Transfers/" class="dropdown-item">l Data Transfers</a>
</li>
                                    
<li>
    <a href="../legacy/l-DomainVerification/" class="dropdown-item">l DomainVerification</a>
</li>
                                    
<li>
    <a href="../legacy/l-ExamplesAccountAuditing/" class="dropdown-item">l ExamplesAccountAuditing</a>
</li>
                                    
<li>
    <a href="../legacy/l-ExamplesCSV/" class="dropdown-item">l ExamplesCSV</a>
</li>
                                    
<li>
    <a href="../legacy/l-ExamplesEmailSettings/" class="dropdown-item">l ExamplesEmailSettings</a>
</li>
                                    
<li>
    <a href="../legacy/l-ExamplesOrganizations/" class="dropdown-item">l ExamplesOrganizations</a>
</li>
                                    
<li>
    <a href="../legacy/l-GAM-Discussion-Group/" class="dropdown-item">GAM Discussion Group</a>
</li>
                                    
<li>
    <a href="../legacy/l-GAM-on-Android-and-Chrome-OS/" class="dropdown-item">l GAM on Android and Chrome OS</a>
</li>
                                    
<li>
    <a href="../legacy/l-GAM-options-files/" class="dropdown-item">l GAM options files</a>
</li>
                                    
<li>
    <a href="../legacy/l-GAM-with--minimal-GCP-rights/" class="dropdown-item">l GAM with  minimal GCP rights</a>
</li>
                                    
<li>
    <a href="../legacy/l-GAM3CSVListings/" class="dropdown-item">l GAM3CSVListings</a>
</li>
                                    
<li>
    <a href="../legacy/l-GAM3DirectoryCommands/" class="dropdown-item">l GAM3DirectoryCommands</a>
</li>
                                    
<li>
    <a href="../legacy/l-GAM3GroupSettings/" class="dropdown-item">l GAM3GroupSettings</a>
</li>
                                    
<li>
    <a href="../legacy/l-Google-Vault---Takeout-Commands/" class="dropdown-item">l Google Vault   Takeout Commands</a>
</li>
                                    
<li>
    <a href="../legacy/l-GoogleDriveManagement/" class="dropdown-item">l GoogleDriveManagement</a>
</li>
                                    
<li>
    <a href="../legacy/l-Grouping-18-or-Older-Users/" class="dropdown-item">Using GAM to group 18+ users</a>
</li>
                                    
<li>
    <a href="../legacy/l-Home/" class="dropdown-item">l Home</a>
</li>
                                    
<li>
    <a href="../legacy/l-How-to-upgrade-from-Standard-GAM/" class="dropdown-item">Installation - Upgrading from Standard GAM</a>
</li>
                                    
<li>
    <a href="../legacy/l-Inbound-SSO-Settings/" class="dropdown-item">l Inbound SSO Settings</a>
</li>
                                    
<li>
    <a href="../legacy/l-LicenseExamples/" class="dropdown-item">l LicenseExamples</a>
</li>
                                    
<li>
    <a href="../legacy/l-Managing-Admins/" class="dropdown-item">l Managing Admins</a>
</li>
                                    
<li>
    <a href="../legacy/l-Managing-CloudPrint-Printers/" class="dropdown-item">l Managing CloudPrint Printers</a>
</li>
                                    
<li>
    <a href="../legacy/l-Managing-Devices/" class="dropdown-item">l Managing Devices</a>
</li>
                                    
<li>
    <a href="../legacy/l-Managing-Google-Classroom/" class="dropdown-item">l Managing Google Classroom</a>
</li>
                                    
<li>
    <a href="../legacy/l-OAuthKeyManagement/" class="dropdown-item">l OAuthKeyManagement</a>
</li>
                                    
<li>
    <a href="../legacy/l-Printers/" class="dropdown-item">l Printers</a>
</li>
                                    
<li>
    <a href="../legacy/l-ResellerCommands/" class="dropdown-item">l ResellerCommands</a>
</li>
                                    
<li>
    <a href="../legacy/l-SecurityExamples/" class="dropdown-item">l SecurityExamples</a>
</li>
                                    
<li>
    <a href="../legacy/l-UnmanagedUsersExamples/" class="dropdown-item">l UnmanagedUsersExamples</a>
</li>
                                    
<li>
    <a href="../legacy/l-Using-GAM-with-a-delegated-admin-service-account-%28DASA%29/" class="dropdown-item">Background</a>
</li>
                                    
<li>
    <a href="../legacy/l-_Footer/" class="dropdown-item">l  Footer</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../Users-Gmail-Labels/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../Users-Gmail-Profile/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#users-gmail-messagesthreads" class="nav-link">Users - Gmail - Messages/Threads</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#notes" class="nav-link">Notes</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#api-documentation" class="nav-link">API documentation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#query-documentation" class="nav-link">Query documentation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#definitions" class="nav-link">Definitions</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#message-queries-with-dates" class="nav-link">Message queries with dates</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#subject-and-label-queries" class="nav-link">Subject and label queries</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#draft-messages" class="nav-link">Draft messages</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#import-messages" class="nav-link">Import messages</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#insert-messages" class="nav-link">Insert messages</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#archive-messages" class="nav-link">Archive messages</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#export-messagesthreads" class="nav-link">Export messages/threads</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#forward-messagesthreads" class="nav-link">Forward messages/threads</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#manage-messagesthreads" class="nav-link">Manage messages/threads</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#delete-messages-by-message-id" class="nav-link">Delete messages by Message-Id</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#display-messagesthreads" class="nav-link">Display messages/threads</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#display-all-messages" class="nav-link">Display all messages</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#display-a-specific-set-of-messages" class="nav-link">Display a specific set of messages</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#display-a-selected-set-of-messages" class="nav-link">Display a selected set of messages</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#choose-information-to-display" class="nav-link">Choose information to display</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#print-only-options" class="nav-link">Print only options</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#show-only-options" class="nav-link">Show only options</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#download-attachments" class="nav-link">Download attachments</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#upload-attachments" class="nav-link">Upload attachments</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#display-messages-sent-by-delegates-for-delegator" class="nav-link">Display messages sent by delegates for delegator</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="users-gmail-messagesthreads">Users - Gmail - Messages/Threads</h1>
<ul>
<li><a href="#notes">Notes</a></li>
<li><a href="#api-documentation">API documentation</a></li>
<li><a href="#query-documentation">Query documentation</a></li>
<li><a href="#definitions">Definitions</a></li>
<li><a href="#subject-and-label-queries">Subject and label queries</a></li>
<li><a href="#draft-messages">Draft messages</a></li>
<li><a href="#import-messages">Import messages</a></li>
<li><a href="#insert-messages">Insert messages</a></li>
<li><a href="#archive-messages">Archive messages</a></li>
<li><a href="#export-messagesthreads">Export messages/threads</a></li>
<li><a href="#forward-messagesthreads">Forward messages/threads</a></li>
<li><a href="#manage-messagesthreads">Manage messages/threads</a></li>
<li><a href="#delete-messages-by-message-id">Delete messages by Message-Id</a></li>
<li><a href="#display-messagesthreads">Display messages/threads</a></li>
<li><a href="#display-all-messages">Display all messages</a></li>
<li><a href="#display-a-specific-set-of-messages">Display a specific set of messages</a></li>
<li><a href="#display-a-selected-set-of-messages">Display a selected set of messages</a></li>
<li><a href="#choose-information-to-display">Choose information to display</a><ul>
<li><a href="#display-message-content">Display message content</a></li>
<li><a href="#display-message-counts">Display message counts</a></li>
<li><a href="#display-label-counts">Display label counts</a></li>
</ul>
</li>
<li><a href="#print-only-options">Print only options</a></li>
<li><a href="#show-only-options">Show only options</a></li>
<li><a href="#download-attachments">Download attachments</a></li>
<li><a href="#upload-attachments">Upload attachments</a></li>
<li><a href="#display-messages-sent-by-delegates-for-delegator">Display messages sent by delegates for delegator</a></li>
<li><a href="Tag-Replace">User attribute <code>replace &lt;Tag&gt; &lt;UserReplacement&gt;</code> processing</a></li>
</ul>
<h2 id="notes">Notes</h2>
<ul>
<li><a href="https://support.google.com/a/answer/2640542">Restrict email messages to authorized addresses or domains only</a></li>
<li><a href="https://support.google.com/a/answer/9175444">Block emails between specific user groups</a></li>
</ul>
<h2 id="api-documentation">API documentation</h2>
<ul>
<li><a href="https://developers.google.com/gmail/api/v1/reference/users.messages">Gmail API - Messages</a></li>
<li><a href="https://developers.google.com/gmail/api/v1/reference/users.threads">Gmail API - Threads</a></li>
<li><a href="https://developers.google.com/gmail/api/v1/reference/users.drafts">Gmail API - Drafts</a></li>
<li><a href="https://developers.google.com/gmail/api/v1/reference/users.messages/import">Gmail API - Import</a></li>
<li><a href="https://developers.google.com/gmail/api/v1/reference/users.messages/insert">Gmail API - Insert</a></li>
<li><a href="https://developers.google.com/admin-sdk/groups-migration/v1/reference/archive/insert">Groups Migration API - Archive</a></li>
</ul>
<h2 id="query-documentation">Query documentation</h2>
<ul>
<li><a href="https://support.google.com/mail/answer/7190">Search Messages</a></li>
</ul>
<p>The document above shows the following  queries in the left column;
they don't work, use the query in the right column.</p>
<table>
<thead>
<tr>
<th>Fails</th>
<th>Works</th>
</tr>
</thead>
<tbody>
<tr>
<td>has:yellow-star</td>
<td>l:^ss_sy</td>
</tr>
<tr>
<td>has:blue-star</td>
<td>l:^ss_sb</td>
</tr>
<tr>
<td>has:red-star</td>
<td>l:^ss_sr</td>
</tr>
<tr>
<td>has:orange-star</td>
<td>l:^ss_so</td>
</tr>
<tr>
<td>has:green-star</td>
<td>l:^ss_sg</td>
</tr>
<tr>
<td>has:purple-star</td>
<td>l:^ss_sp</td>
</tr>
<tr>
<td>has:red-bang</td>
<td>l:^ss_cr</td>
</tr>
<tr>
<td>has:yellow-bang</td>
<td>l:^ss_cy</td>
</tr>
<tr>
<td>has:blue-info</td>
<td>l:^ss_cb</td>
</tr>
<tr>
<td>has:orange-guillemet</td>
<td>l:^ss_co</td>
</tr>
<tr>
<td>has:green-check</td>
<td>l:^ss_cg</td>
</tr>
<tr>
<td>has:purple-question</td>
<td>l:^ss_cp</td>
</tr>
</tbody>
</table>
<p>This table and other suggestions came from:
* https://www.planetahuevo.es/uso-de-gmail-avanzado-saca-partido-a-tu-gmail/</p>
<h2 id="definitions">Definitions</h2>
<ul>
<li><a href="Collections-of-Users"><code>&lt;UserTypeEntity&gt;</code></a></li>
<li><a href="Command-Data-From-Google-Docs-Sheets-Storage">Command data from Google Docs/Sheets/Storage</a></li>
</ul>
<pre><code>&lt;DomainName&gt; ::= &lt;String&gt;(.&lt;String&gt;)+
&lt;EmailAddress&gt; ::= &lt;String&gt;@&lt;DomainName&gt;
&lt;UniqueID&gt; ::= id:&lt;String&gt;
&lt;GroupItem&gt; ::= &lt;EmailAddress&gt;|&lt;UniqueID&gt;|&lt;String&gt;
&lt;LabelID&gt; ::= &lt;String&gt;
&lt;LabelIDList&gt; ::= &quot;&lt;LabelID&gt;(,&lt;LabelID)*&quot;
&lt;LabelName&gt; ::= &lt;String&gt;
&lt;QueryGmail&gt; ::= &lt;String&gt; See: https://support.google.com/mail/answer/7190
&lt;Time&gt; ::=
        &lt;Year&gt;-&lt;Month&gt;-&lt;Day&gt;(&lt;Space&gt;|T)&lt;Hour&gt;:&lt;Minute&gt;:&lt;Second&gt;[.&lt;MilliSeconds&gt;](Z|(+|-(&lt;Hour&gt;:&lt;Minute&gt;))) |
        (+|-)&lt;Number&gt;(m|h|d|w|y) |
        never|
        now|today

&lt;RegularExpression&gt; ::= &lt;String&gt;
        See: https://docs.python.org/3/library/re.html
&lt;REMatchPattern&gt; ::= &lt;RegularExpression&gt;
&lt;RESearchPattern&gt; ::= &lt;RegularExpression&gt;
&lt;RESubstitution&gt; ::= &lt;String&gt;&gt;

&lt;SMTPDateHeader&gt; ::=
        date|
        delivery-date|
        expires|
        expiry-date|
        latest-delivery-time|
        reply-by|
        resent-date
&lt;SMTPHeader&gt; ::=
        accept-language|
        alternate-recipient|
        autoforwarded|
        autosubmitted|
        bcc|
        cc|
        comments|
        content-alternative|
        content-base|
        content-description|
        content-disposition|
        content-duration|
        content-id|
        content-identifier|
        content-language|
        content-location|
        content-md5|
        content-return|
        content-transfer-encoding|
        content-type|
        content-features|
        conversion|
        conversion-with-loss|
        dl-expansion-history|
        deferred-delivery|
        delivered-to|
        discarded-x400-ipms-extensions|
        discarded-x400-mts-extensions|
        disclose-recipients|
        disposition-notification-options|
        disposition-notification-to|
        encoding|
        encrypted|
        from|
        generate-delivery-report|
        importance|
        in-reply-to|
        incomplete-copy|
        keywords|
        language|
        list-archive|
        list-help|
        list-id|
        list-owner|
        list-post|
        list-subscribe|
        list-unsubscribe|
        mime-version|
        message-context|
        message-id|
        message-type|
        obsoletes|
        original-encoded-information-types|
        original-message-id|
        originator-return-address|
        pics-label|
        prevent-nondelivery-report|
        priority|
        received|
        references|
        reply-to|
        resent-bcc|
        resent-cc|
        resent-from|
        resent-message-id|
        resent-reply-to|
        resent-sender|
        resent-to|
        return-path|
        sender|
        sensitivity|
        subject|
        supersedes|
        to|
        x400-content-identifier|
        x400-content-return|
        x400-content-type|
        x400-mts-identifier|
        x400-originator|
        x400-received|
        x400-recipients|
        x400-trace
&lt;SMTPHeaderList&gt; ::= &quot;&lt;SMTPDateHeader|SMTPHeader&gt;(,&lt;SMTPDateHeader|SMTPHeader&gt;)*&quot;

&lt;MessageID&gt; ::= &lt;String&gt;  # This is the Google internal message ID, not the RFC822 message ID
&lt;MessageIDList&gt; ::= &quot;&lt;MessageID&gt;(,&lt;MessageID&gt;)*&quot;
&lt;MessageIDEntity&gt; ::=
        &lt;MessageIDList&gt; | &lt;FileSelector&gt; | &lt;CSVkmdSelector&gt; | &lt;CSVDataSelector&gt;
        See: https://github.com/GAM-team/GAM/wiki/Collections-of-Items
&lt;ThreadID&gt; ::= &lt;String&gt;
&lt;ThreadIDList&gt; ::= &quot;&lt;ThreadID&gt;(,&lt;ThreadID&gt;)*&quot;
&lt;ThreadIDEntity&gt; ::= &lt;ThreadIDList&gt;|&lt;FileSelector&gt;|&lt;CSVkmdSelector&gt;|&lt;CSVDataSelector&gt;

&lt;StorageBucketName&gt; ::= &lt;String&gt;
&lt;StorageObjectName&gt; ::= &lt;String&gt;
&lt;StorageBucketObjectName&gt; ::=
        https://storage.cloud.google.com/&lt;StorageBucketName&gt;/&lt;StorageObjectName&gt;|
        https://storage.googleapis.com/&lt;StorageBucketName&gt;/&lt;StorageObjectName&gt;|
        gs://&lt;StorageBucketName&gt;/&lt;StorageObjectName&gt;|
        &lt;StorageBucketName&gt;/&lt;StorageObjectName&gt;

&lt;UserGoogleDoc&gt; ::=
        &lt;EmailAddress&gt; &lt;DriveFileIDEntity&gt;|&lt;DriveFileNameEntity&gt;|(&lt;SharedDriveEntity&gt; &lt;SharedDriveFileNameEntity&gt;)

&lt;MessageContent&gt; ::=
        (message|textmessage|htmlmessage &lt;String&gt;)|
        (file|textfile|htmlfile &lt;FileName&gt; [charset &lt;Charset&gt;])|
        (gdoc|ghtml &lt;UserGoogleDoc&gt;)|
        (gcsdoc|gcshtml &lt;StorageBucketObjectName&gt;)|
        (emlfile &lt;FileName&gt; [charset &lt;Charset&gt;]))

&lt;DriveFolderID&gt; ::= &lt;String&gt;
&lt;DriveFolderName&gt; ::= &lt;String&gt;
&lt;SharedDriveID&gt; ::= &lt;String&gt;
&lt;SharedDriveName&gt; ::= &lt;String&gt;

&lt;DriveFileParentAttribute&gt; ::=
        (parentid &lt;DriveFolderID&gt;)|
        (parentname &lt;DriveFolderName&gt;)|
        (anyownerparentname &lt;DriveFolderName&gt;)|
        (teamdriveparentid &lt;DriveFolderID&gt;)|
        (teamdriveparent &lt;SharedDriveName&gt;)|
        (teamdriveparentid &lt;SharedDriveID&gt; teamdriveparentname &lt;DriveFolderName&gt;)|
        (teamdriveparent &lt;SharedDriveName&gt; teamdriveparentname &lt;DriveFolderName&gt;)
</code></pre>
<h2 id="message-queries-with-dates">Message queries with dates</h2>
<pre><code>query &lt;QueryGmail&gt; [querytime&lt;String&gt; &lt;Date&gt;]*
</code></pre>
<ul>
<li><code>query "xxx"</code> - <code>xxx</code> is appended to the current query; you can repeat the query argument to build up a longer query.</li>
</ul>
<p>Use the <code>querytime&lt;String&gt; &lt;Date&gt;</code> option to allow dates, usually relative, to be substituted into the <code>query &lt;QueryGmail&gt;</code> option.
The <code>querytime&lt;String&gt; &lt;Date&gt;</code> value replaces the string <code>#querytime&lt;String&gt;#</code> in any queries.
The characters following <code>querytime</code> can be any combination of lowercase letters and numbers. This is most useful in scripts
where you can specify a relative date without having to change the script.</p>
<p>For example, query for messages from moree than 5 years ago:</p>
<pre><code>querytime5years -5y query &quot;before:#querytime5years#&quot;
</code></pre>
<h2 id="subject-and-label-queries">Subject and label queries</h2>
<p>Using a query to select messages by subject or label requires some attention in order to achieve the desired effect.
* https://support.google.com/mail/answer/7190</p>
<p>To select messages with all of the words (<code>word1</code>, <code>word2</code> and <code>word3</code>) in the subject, regardless of location or order, use:
* <code>query "subject:word1 word2 word3"</code></p>
<p>To select messages with exactly (<code>word1 word2 word3</code>) in the subject, use:
* <code>query "subject:\"word1 word2 word3\""</code></p>
<p>To select messages with a label containing <code>&amp;()"|{}/</code>, you have to replace these characters with <code>-</code> in the query.
You can also replace <code></code> with <code>-</code> but it doesn't seem to be required.</p>
<ul>
<li><code>query "label:Foo -Bar-"</code> - Select messages with label <code>Foo (Bar)</code></li>
</ul>
<p>You can have GAM do the substitutions for you with the <code>matchlabel &lt;LabelName&gt;</code> option.
* <code>matchlabel "Foo (Bar)"</code> is converted to <code>query "label:Foo -Bar-"</code></p>
<h2 id="draft-messages">Draft messages</h2>
<p>Add a draft message to a user's mailbox.</p>
<pre><code>gam &lt;UserTypeEntity&gt; draft message
        &lt;MessageContent&gt;
        (replace &lt;Tag&gt; &lt;UserReplacement&gt;)*
        (replaceregex &lt;RESearchPattern&gt; &lt;RESubstitution&gt; &lt;Tag&gt; &lt;UserReplacement&gt;)*
        (&lt;SMTPDateHeader&gt; &lt;Time&gt;)* (&lt;SMTPHeader&gt; &lt;String&gt;)* (header &lt;String&gt; &lt;String&gt;)*
        (attach &lt;FileName&gt; [charset &lt;Charset&gt;])*
        (embedimage &lt;FileName&gt; &lt;String&gt;)*
</code></pre>
<p><code>&lt;MessageContent&gt;</code> is the message, there are five ways to specify it:
* <code>message|textmessage|htmlmessage &lt;String&gt;</code> - Use <code>&lt;String&gt;</code> as the message
* <code>file|htmlfile &lt;FileName&gt; [charset &lt;Charset&gt;]</code> - Read the message from <code>&lt;FileName&gt;</code>
* <code>gdoc|ghtml &lt;UserGoogleDoc&gt;</code> - Read the message from <code>&lt;UserGoogleDoc&gt;</code>
* <code>gcsdoc|gcshtml &lt;StorageBucketObjectName&gt;</code> - Read the message from the Google Cloud Storage file <code>&lt;StorageBucketObjectName&gt;</code>
* <code>emlfile &lt;FileName&gt; [charset &lt;Charset&gt;]</code> - Read the message from the EML message file <code>&lt;FileName&gt;</code>. SMTP headers specified in the command will replace those in the message file. The default <code>charset</code> is <code>ascii</code>.</p>
<p>The <code>&lt;SMTPDateHeader&gt; &lt;Time&gt;</code> argument  requires <code>&lt;Time&gt;</code> values which will be converted to RFC2822 dates. If you have these headers with values that
are not in <code>&lt;Time&gt;</code> format, use the argument <code>header &lt;SMTPDateHeader&gt; &lt;String&gt;</code>.</p>
<p>If you have an SMTP header that is not found in <code>&lt;SMTPDateHeader&gt;</code> or <code>&lt;SMTPHeader&gt;</code>, use <code>header &lt;String&gt; &lt;String&gt;</code>.</p>
<p>The <code>&lt;SMTPHeader&gt;</code> value <code>content-type</code> is not valid for these commands; it will be derived from other arguments.</p>
<p>You can embed images in HTML email messages.</p>
<p>Your HTML message will contain lines like this:</p>
<pre><code>&lt;img src=&quot;cid:image1&quot;/&gt;
&lt;img src=&quot;cid:image2&quot;/&gt;
</code></pre>
<p>Your command line will have: <code>embedimage file1.jpg image1 embedimage file2.jpg image2</code></p>
<h2 id="import-messages">Import messages</h2>
<p>Import a message into a user's mailbox, with standard email delivery scanning and classification similar to receiving via SMTP.</p>
<pre><code>gam &lt;UserTypeEntity&gt; import message
        &lt;MessageContent&gt;
        (replace &lt;Tag&gt; &lt;UserReplacement&gt;)*
        (replaceregex &lt;RESearchPattern&gt; &lt;RESubstitution&gt; &lt;Tag&gt; &lt;UserReplacement&gt;)*
        (&lt;SMTPDateHeader&gt; &lt;Time&gt;)* (&lt;SMTPHeader&gt; &lt;String&gt;)* (header &lt;String&gt; &lt;String&gt;)*
        (addlabel &lt;LabelName&gt;)* [labels &lt;LabelNameList&gt;]
        (attach &lt;FileName&gt; [charset &lt;Charset&gt;])*
        (embedimage &lt;FileName&gt; &lt;String&gt;)*
        [deleted [&lt;Boolean&gt;]] [checkspam [&lt;Boolean&gt;]] [processforcalendar [&lt;Boolean&gt;]]
</code></pre>
<p><code>&lt;MessageContent&gt;</code> is the message, there are five ways to specify it:
* <code>message|textmessage|htmlmessage &lt;String&gt;</code> - Use <code>&lt;String&gt;</code> as the message
* <code>file|htmlfile &lt;FileName&gt; [charset &lt;Charset&gt;]</code> - Read the message from <code>&lt;FileName&gt;</code>
* <code>gdoc|ghtml &lt;UserGoogleDoc&gt;</code> - Read the message from <code>&lt;UserGoogleDoc&gt;</code>
* <code>gcsdoc|gcshtml &lt;StorageBucketObjectName&gt;</code> - Read the message from the Google Cloud Storage file <code>&lt;StorageBucketObjectName&gt;</code>
* <code>emlfile &lt;FileName&gt; [charset &lt;Charset&gt;]</code> - Read the message from the EML message file <code>&lt;FileName&gt;</code>. SMTP headers specified in the command will replace those in the message. The default <code>chatser</code> is <code>ascii</code>.</p>
<p>When <code>emlfile</code> is not specified:
* If <code>to</code> is not specified, it is set to the user email addresses in <code>&lt;UserTypeEntity&gt;</code>.
* If <code>from</code> is not specified, it is set to the admin user identified in oauth2.txt.</p>
<p>The <code>&lt;SMTPDateHeader&gt; &lt;Time&gt;</code> argument  requires <code>&lt;Time&gt;</code> values which will be converted to RFC2822 dates. If you have these headers with values that
are not in <code>&lt;Time&gt;</code> format, use the argument <code>header &lt;SMTPDateHeader&gt; &lt;String&gt;</code>.</p>
<p>If you have an SMTP header that is not found in <code>&lt;SMTPDateHeader&gt;</code> or <code>&lt;SMTPHeader&gt;</code>, use <code>header &lt;String&gt; &lt;String&gt;</code>.</p>
<p>The <code>&lt;SMTPHeader&gt;</code> value <code>content-type</code> is not valid for these commands; it will be derived from other arguments.</p>
<p>If no <code>addlabel &lt;LabelName&gt;</code> is specified, the message will be placed in the Inbox.</p>
<p>You can embed images in HTML email messages.</p>
<p>Your HTML message will contain lines like this:</p>
<pre><code>&lt;img src=&quot;cid:image1&quot;/&gt;
&lt;img src=&quot;cid:image2&quot;/&gt;
</code></pre>
<p>Your command line will have: <code>embedimage file1.jpg image1</code> embedimage file2.jpg image2`</p>
<p><code>deleted</code> defaults to False, when True: Mark the email as permanently deleted (not TRASH) and only visible in Google Vault to a Vault administrator.</p>
<p><code>checkspam</code> defaults to False: Ignore the Gmail spam classifier decision and never mark this email as SPAM in the mailbox.</p>
<p><code>processforcalendar</code> defaults to False, when True: Process calendar invites in the email and add any extracted meetings to the Google Calendar for this user.</p>
<h2 id="insert-messages">Insert messages</h2>
<p>Insert a message into a user's mailbox similar to IMAP APPEND, bypassing most scanning and classification.</p>
<pre><code>gam &lt;UserTypeEntity&gt; insert message
        &lt;MessageContent&gt;
        (replace &lt;Tag&gt; &lt;UserReplacement&gt;)*
        (replaceregex &lt;RESearchPattern&gt; &lt;RESubstitution&gt; &lt;Tag&gt; &lt;UserReplacement&gt;)*
        (&lt;SMTPDateHeader&gt; &lt;Time&gt;)* (&lt;SMTPHeader&gt; &lt;String&gt;)* (header &lt;String&gt; &lt;String&gt;)*
        (addlabel &lt;LabelName&gt;)* [labels &lt;LabelNameList&gt;]
        (attach &lt;FileName&gt; [charset &lt;Charset&gt;])*
        (embedimage &lt;FileName&gt; &lt;String&gt;)*
        [deleted [&lt;Boolean&gt;]]
</code></pre>
<p><code>&lt;MessageContent&gt;</code> is the message, there are five ways to specify it:
* <code>message|textmessage|htmlmessage &lt;String&gt;</code> - Use <code>&lt;String&gt;</code> as the message
* <code>file|htmlfile &lt;FileName&gt; [charset &lt;Charset&gt;]</code> - Read the message from <code>&lt;FileName&gt;</code>
* <code>gdoc|ghtml &lt;UserGoogleDoc&gt;</code> - Read the message from <code>&lt;UserGoogleDoc&gt;</code>
* <code>gcsdoc|gcshtml &lt;StorageBucketObjectName&gt;</code> - Read the message from the Google Cloud Storage file <code>&lt;StorageBucketObjectName&gt;</code>
* <code>emlfile &lt;FileName&gt; [charset &lt;Charset&gt;]</code> - Read the message from the EML message file <code>&lt;FileName&gt;</code>. SMTP headers specified in the command will replace those in the message file. The default <code>chatser</code> is <code>ascii</code>.</p>
<p>When <code>emlfile</code> is not specified:
* If <code>to</code> is not specified, it is set to the user email addresses in <code>&lt;UserTypeEntity&gt;</code>.
* If <code>from</code> is not specified, it is set to the admin user identified in oauth2.txt.</p>
<p>The <code>&lt;SMTPDateHeader&gt; &lt;Time&gt;</code> argument  requires <code>&lt;Time&gt;</code> values which will be converted to RFC2822 dates. If you have these headers with values that
are not in <code>&lt;Time&gt;</code> format, use the argument <code>header &lt;SMTPDateHeader&gt; &lt;String&gt;</code>.</p>
<p>If you have an SMTP header that is not found in <code>&lt;SMTPDateHeader&gt;</code> or <code>&lt;SMTPHeader&gt;</code>, use <code>header &lt;String&gt; &lt;String&gt;</code>.</p>
<p>The <code>&lt;SMTPHeader&gt;</code> value <code>content-type</code> is not valid for these commands; it will be derived from other arguments.</p>
<p>If no <code>addlabel &lt;LabelName&gt;</code> is specified, the message will be placed in the Inbox.</p>
<p>You can embed images in HTML email messages.</p>
<p>Your HTML message will contain lines like this:</p>
<pre><code>&lt;img src=&quot;cid:image1&quot;/&gt;
&lt;img src=&quot;cid:image2&quot;/&gt;
</code></pre>
<p>Your command line will have: <code>embedimage file1.jpg image1</code> embedimage file2.jpg image2`</p>
<p><code>deleted</code> defaults to False, when True: Mark the email as permanently deleted (not TRASH) and only visible in Google Vault to a Vault administrator.</p>
<h2 id="archive-messages">Archive messages</h2>
<pre><code>gam &lt;UserTypeEntity&gt; archive messages &lt;GroupItem&gt;
        (((query &lt;QueryGmail&gt; [querytime&lt;String&gt; &lt;Date&gt;]*) (matchlabel &lt;LabelName&gt;) [or|and])+
         [labelids &lt;LabelIDList&gt;]
         [quick|notquick] [doit] [max_to_archive &lt;Number&gt;])|(ids &lt;MessageIDEntity&gt;)
        [csv [todrive &lt;ToDriveAttribute&gt;*]]
</code></pre>
<p>Messages are archived to the group specified by <code>&lt;GroupItem&gt;</code>.</p>
<h3 id="archive-a-specific-set-of-messages">Archive  a specific set of messages</h3>
<ul>
<li><code>ids &lt;MessageIDEntity&gt;</code> - A list of message ids</li>
</ul>
<h3 id="archive-a-selected-set-of-messages">Archive a selected set of messages</h3>
<ul>
<li><code>((query &lt;QueryGmail&gt; [querytime&lt;String&gt; &lt;Date&gt;]*) (matchlabel &lt;LabelName&gt;) [or|and])+</code> - Criteria to select messages</li>
<li><code>labelids &lt;LabelIDList&gt;</code> - Select messages with labels that match all of the specified label IDs.</li>
<li><code>max_to_archive</code> - Limit the number of messages that will be archived; use a value of 0 for no limit</li>
<li><code>doit</code> - No messages are archived unless you specify <code>doit</code>. By not specifying <code>doit</code>, you can preview the messages selected to verify that the results match your expectations.</li>
</ul>
<p>When <code>matchlabel &lt;LabelName&gt;</code> is specified, the following characters are replaced with a <code>-</code> in the generated query.</p>
<pre><code> &amp;()&quot;|{}/
</code></pre>
<p>By default, Gam fetches all matching messages from Google and then processes only <code>max_to_archive</code> of them.
To speed up fetching, specify <code>quick</code> and only <code>max_to_archive</code> of the matching messages will be fetched.
You must still specify <code>doit</code> to perform the operation.</p>
<p>By default, the command results are displayed as indented keys and values. Use the <code>csv</code> option
to display the command results in CSV form.</p>
<pre><code>$ gam user user@domain.com archive messages ids 18e9fc6581b9acab,18e9fc58c5491f4c    
User: user@domain.com, Archive 2 Messages
  User: user@domain.com, Message: 18e9fc6581b9acab, Archived (1/2)
  User: user@domain.com, Message: 18e9fc58c5491f4c, Archived (2/2)
$ gam user user@domain.com archive messages ids 18e9fc6581b9acab,18e9fc58c5491f4c csv
User: user@domain.com, Archive 2 Messages
User,id,action,error
user@domain.com,18e9fc6581b9acab,Archived,
user@domain.com,18e9fc58c5491f4c,Archived,
</code></pre>
<p>See below for message selection.</p>
<h2 id="export-messagesthreads">Export messages/threads</h2>
<p>Export messages in EML format.</p>
<pre><code>gam &lt;UserTypeEntity&gt; export message|messages
        (((query &lt;QueryGmail&gt; [querytime&lt;String&gt; &lt;Date&gt;]*) (matchlabel &lt;LabelName&gt;) [or|and])+
         [labelids &lt;LabelIDList&gt;]
         [quick|notquick] [max_to_export &lt;Number&gt;])|(ids &lt;MessageIDEntity&gt;)
        [targetfolder &lt;FilePath&gt;] [targetname &lt;FileName&gt;] [overwrite [&lt;Boolean&gt;]]
gam &lt;UserTypeEntity&gt; export thread|threads
        (((query &lt;QueryGmail&gt; [querytime&lt;String&gt; &lt;Date&gt;]*) (matchlabel &lt;LabelName&gt;) [or|and])+
         [labelids &lt;LabelIDList&gt;]
         [quick|notquick] [max_to_export &lt;Number&gt;])|(ids &lt;MessageIDEntity&gt;)
        [targetfolder &lt;FilePath&gt;] [targetname &lt;FileName&gt;] [overwrite [&lt;Boolean&gt;]]
</code></pre>
<p>By default, when exporting a message, it is downloaded to the directory specified in <code>gam.cfg/drive_dir</code>.
* <code>targetfolder &lt;FilePath&gt;</code> - Specify an alternate location for the downloaded file.</p>
<p>By default, when exporting a message, the local name is <code>Msg-&lt;MessageID&gt;</code>.
* <code>targetname &lt;FileName&gt;</code> - Specify an alternate name for the downloaded file; <code>#id#</code> will be replaced by <code>&lt;MessageID&gt;</code>.</p>
<p>The strings <code>#email#</code>, <code>#user#</code> and <code>#username#</code> will be replaced by the the user's full email address or just the name portion
in <code>targetfolder &lt;FilePath&gt;</code> and <code>targetname &lt;FileName&gt;</code>.</p>
<p>By default, when exporting a message, an existing local file will not be overwritten; a numeric prefix is added to the filename.
* <code>overwrite</code> - Overwite an existing file
* <code>overwrite true</code> - Overwite an existing file
* <code>overwrite false</code> - Do not overwite an existing file; add a numeric prefix and create a new file</p>
<p>See below for message selection.</p>
<h2 id="forward-messagesthreads">Forward messages/threads</h2>
<pre><code>gam &lt;UserTypeEntity&gt; forward message|messages recipient|to &lt;RecipientEntity&gt;
        (((query &lt;QueryGmail&gt; [querytime&lt;String&gt; &lt;Date&gt;]*) (matchlabel &lt;LabelName&gt;) [or|and])+
         [labelids &lt;LabelIDList&gt;]
         [quick|notquick] [doit] [max_to_forward &lt;Number&gt;])|(ids &lt;MessageIDEntity&gt;)
         [subject &lt;String&gt;] [addorigfieldstosubject]
gam &lt;UserTypeEntity&gt; forward thread|threads recipient|to &lt;RecipientEntity&gt;
        (((query &lt;QueryGmail&gt; [querytime&lt;String&gt; &lt;Date&gt;]*) (matchlabel &lt;LabelName&gt;) [or|and])+
         [labelids &lt;LabelIDList&gt;]
         [quick|notquick] [doit] [max_to_forward &lt;Number&gt;])|(ids &lt;ThreadIDEntity&gt;)
         [subject &lt;String&gt;] [addorigfieldstosubject]
</code></pre>
<p>By default, the message subject has <code>Fwd:</code> prepended; use <code>subject &lt;String&gt;</code> to specify a new subject.</p>
<p>All <code>Cc</code> addresses are removed from the forwarded message.</p>
<p>If <code>addorigfieldstosubject</code> is specified, GAM appends the original <code>from</code>, <code>to</code> and <code>date</code> fields to the message subject.</p>
<pre><code>Fwd: Ross to TestUser (Original From: Ross Scroggs &lt;ross.scroggs@gmail.com&gt; To: testuser@domain.com Date: Thu, 23 Nov 2023 07:01:59 -0800)
</code></pre>
<p>See below for message selection.</p>
<h2 id="manage-messagesthreads">Manage messages/threads</h2>
<pre><code>gam &lt;UserTypeEntity&gt; delete messages|threads
        (((query &lt;QueryGmail&gt; [querytime&lt;String&gt; &lt;Date&gt;]*) (matchlabel &lt;LabelName&gt;) [or|and])+
         [labelids &lt;LabelIDList&gt;]
         [quick|notquick] [doit] [max_to_delete &lt;Number&gt;])|(ids &lt;MessageIDEntity&gt;)
        [csv [todrive &lt;ToDriveAttribute&gt;*]]
gam &lt;UserTypeEntity&gt; modify messages|threads
        (((query &lt;QueryGmail&gt; [querytime&lt;String&gt; &lt;Date&gt;]*) (matchlabel &lt;LabelName&gt;) [or|and])+
         [labelids &lt;LabelIDList&gt;]
         [quick|notquick] [doit] [max_to_modify &lt;Number&gt;])|(ids &lt;MessageIDEntity&gt;)
        ((addlabel &lt;LabelName&gt;)|(removelabel &lt;LabelName&gt;))+
        [csv [todrive &lt;ToDriveAttribute&gt;*]]
gam &lt;UserTypeEntity&gt; spam messages|threads
        (((query &lt;QueryGmail&gt; [querytime&lt;String&gt; &lt;Date&gt;]*) (matchlabel &lt;LabelName&gt;) [or|and])+
         [labelids &lt;LabelIDList&gt;]
         [quick|notquick] [doit] [max_to_spam &lt;Number&gt;])|(ids &lt;MessageIDEntity&gt;)
        [csv [todrive &lt;ToDriveAttribute&gt;*]]
gam &lt;UserTypeEntity&gt; trash messages|threads
        (((query &lt;QueryGmail&gt; [querytime&lt;String&gt; &lt;Date&gt;]*) (matchlabel &lt;LabelName&gt;) [or|and])+
         [labelids &lt;LabelIDList&gt;]
         [quick|notquick] [doit] [max_to_trash &lt;Number&gt;])|(ids &lt;MessageIDEntity&gt;)
        [csv [todrive &lt;ToDriveAttribute&gt;*]]
gam &lt;UserTypeEntity&gt; untrash messages|threads
        (((query &lt;QueryGmail&gt; [querytime&lt;String&gt; &lt;Date&gt;]*) (matchlabel &lt;LabelName&gt;) [or|and])+
         [labelids &lt;LabelIDList&gt;]
         [quick|notquick] [doit] [max_to_untrash &lt;Number&gt;])|(ids &lt;MessageIDEntity&gt;)
        [csv [todrive &lt;ToDriveAttribute&gt;*]]
</code></pre>
<p>By default, the command results are displayed as indented keys and values. Use the <code>csv</code> option
to display the command results in CSV form.</p>
<pre><code>$ gam user user@domain.com delete messages ids 18e9fc6581b9acab,18e9fc58c5491f4c    
User: user@domain.com, Delete 2 Messages
  User: user@domain.com, Message: 18e9fc6581b9acab, Deleted (1/2)
  User: user@domain.com, Message: 18e9fc58c5491f4c, Deleted (2/2)
$ gam user user@domain.com delete messages ids 18e9fc6581b9acab,18e9fc58c5491f4c csv
User: user@domain.com, Delete 2 Messages
User,id,action,error
user@domain.com,18e9fc6581b9acab,Deleted,
user@domain.com,18e9fc58c5491f4c,Deleted,
</code></pre>
<h3 id="manage-a-specific-set-of-messages">Manage a specific set of messages</h3>
<ul>
<li><code>ids &lt;MessageIDEntity&gt;</code> - A list of message ids</li>
</ul>
<h3 id="manage-a-selected-set-of-messages">Manage a selected set of messages</h3>
<ul>
<li><code>((query &lt;QueryGmail&gt; [querytime&lt;String&gt; &lt;Date&gt;]*) (matchlabel &lt;LabelName&gt;) [or|and])+</code> - Criteria to select messages</li>
<li><code>labelids &lt;LabelIDList&gt;</code> - Select messages with labels that match all of the specified label IDs.</li>
<li><code>max_to_xxx</code> - Limit the number of messages that will be processed; use a value of 0 for no limit</li>
<li><code>doit</code> - No messages are processed unless you specify <code>doit</code>. By not specifying <code>doit</code>, you can preview the messages selected to verify that the results match your expectations.</li>
</ul>
<p>When <code>matchlabel &lt;LabelName&gt;</code> is specified, the following characters are replaced with a <code>-</code> in the generated query.</p>
<pre><code> &amp;()&quot;|{}/
</code></pre>
<p>By default, Gam fetches all matching messages from Google and then processes only <code>max_to_process</code> of them.
To speed up fetching, specify <code>quick</code> and only <code>max_to_process</code> of the matching messages will be fetched.
You must still specify <code>doit</code> to perform the operation.</p>
<h2 id="delete-messages-by-message-id">Delete messages by Message-Id</h2>
<p>Sometimes multiple users in your domain receive an inappropriate message that you'd like to delete.
From any user that received the message (or the one that sent it), you have to obtain the Message-Id. That looks like this:</p>
<pre><code>Message-Id: &lt;B1A91373-49E1-4235-8290-3E991E998A76@domain.com&gt;
</code></pre>
<p>If you know Bob Smith sent the message or is someone you know received it and the subject is "New org chart next year", you can quickly find it like this:</p>
<pre><code>gam user bob.smith@yourdomain.com print messages query &quot;\&quot;New org chart next year\&quot;&quot; headers subject,to,message-id
</code></pre>
<p>This will print a list of messages that match; by looking at the addressees, you can select which message ID(s) are relevant.</p>
<p>To delete the message for all users:</p>
<pre><code>gam config auto_batch_min 1 all users delete message query &quot;rfc822msgid:&lt;B1A91373-49E1-4235-8290-3E991E998A76@domain.com&gt;&quot; doit
</code></pre>
<p>If your domain has many users, this process might still take a while. You can target a subset of users, for instance by Org unit or group. Refer to <a href="https://github.com/GAM-team/GAM/wiki/Collections-of-Users">Collections of Users</a> for all available options. For example, to target all users in the Org unit Sales:</p>
<pre><code>gam config auto_batch_min 1 ou_and_children Sales delete message query &quot;rfc822msgid:&lt;B1A91373-49E1-4235-8290-3E991E998A76@domain.com&gt;&quot; doit
</code></pre>
<p>Or all users in the EastOffice group, including subgroups:</p>
<pre><code>gam config auto_batch_min 1 groups_inde EastOffice delete message query &quot;rfc822msgid:&lt;B1A91373-49E1-4235-8290-3E991E998A76@domain.com&gt;&quot; doit
</code></pre>
<h2 id="display-messagesthreads">Display messages/threads</h2>
<pre><code>gam &lt;UserTypeEntity&gt; show messages|threads
        (((query &lt;QueryGmail&gt; [querytime&lt;String&gt; &lt;Date&gt;]*) (matchlabel &lt;LabelName&gt;) [or|and])*
         [labelids &lt;LabelIDList&gt;]
         [quick|notquick] [max_to_show &lt;Number&gt;] [includespamtrash])|(ids &lt;MessageIDEntity&gt;)
        [labelmatchpattern &lt;REMatchPattern&gt;] [sendermatchpattern &lt;REMatchPattern&gt;]
        [countsonly|positivecountsonly]
        [headers all|&lt;SMTPHeaderList&gt;] [dateheaderformat iso|rfc2822|&lt;String&gt;] [dateheaderconverttimezone [&lt;Boolean&gt;]]
        [showlabels] [useronly] [delimiter &lt;Character&gt;] [showbody] [showhtml] [showdate] [showsize] [showsnippet]
        [maxmessagesperthread &lt;Number&gt;]
        [showattachments [attachmentnamepattern &lt;REMatchPattern&gt;&gt;] [noshowtextplain]]
        [saveattachments [attachmentnamepattern &lt;REMatchPattern&gt;&gt;]]
            [targetfolder &lt;FilePath&gt;] [overwrite [&lt;Boolean&gt;]]
gam &lt;UserTypeEntity&gt; print messages|threads [todrive &lt;ToDriveAttribute&gt;*]
        (((query &lt;QueryGmail&gt; [querytime&lt;String&gt; &lt;Date&gt;]*) (matchlabel &lt;LabelName&gt;) [or|and])*
         [labelids &lt;LabelIDList&gt;]
         [quick|notquick] [max_to_print &lt;Number&gt;] [includespamtrash])|(ids &lt;MessageIDEntity&gt;)
        [labelmatchpattern &lt;REMatchPattern&gt;] [sendermatchpattern &lt;REMatchPattern&gt;]
        [countsonly|positivecountsonly]
        [headers all|&lt;SMTPHeaderList&gt;] [dateheaderformat iso|rfc2822|&lt;String&gt;] [dateheaderconverttimezone [&lt;Boolean&gt;]]
        [showlabels] [useronly] [delimiter &lt;Character&gt;] [showbody] [showhtml] [showdate] [showsize] [showsnippet]
        [maxmessagesperthread &lt;Number&gt;]
        [showattachments [attachmentnamepattern &lt;REMatchPattern&gt;&gt;]]
        [convertcrnl]
        (addcsvdata &lt;FieldName&gt; &lt;String&gt;)*
</code></pre>
<h2 id="display-all-messages">Display all messages</h2>
<p>By default, Gam displays all messages.
* <code>max_to_xxx</code> - Limit the number of messages that will be displayed
* <code>includespamtrash</code> - Include messages in the Spam and Trash folders</p>
<p>By default, all messages in a thread are displayed with <code>print|show threads</code>.
Use <code>maxmessagesperthread &lt;Number&gt;</code> to limit the number of messages displayed for a thread.
For example, this can be used if you only want to see the first message of each thread.</p>
<pre><code>gam user user@domain.com print|show threads maxmessagesperthread 1
</code></pre>
<h2 id="display-a-specific-set-of-messages">Display a specific set of messages</h2>
<ul>
<li><code>ids &lt;MessageIDEntity&gt;</code> - A list of message ids</li>
</ul>
<h2 id="display-a-selected-set-of-messages">Display a selected set of messages</h2>
<ul>
<li><code>((query &lt;QueryGmail&gt; [querytime&lt;String&gt; &lt;Date&gt;]*) (matchlabel &lt;LabelName&gt;) [or|and])+</code> - Criteria to select messages</li>
<li><code>labelids &lt;LabelIDList&gt;</code> - Select messages with labels that match all of the specified label IDs.</li>
<li><code>max_to_xxx</code> - Limit the number of messages that will be displayed</li>
<li><code>includespamtrash</code> - Include messages in the Spam and Trash folders</li>
<li><code>labelmatchpattern &lt;REMatchPattern&gt;</code> - Only display messages with some label that matches <code>&lt;REMatchPattern&gt;</code></li>
<li><code>labelmatchpattern xyz</code> - Label must start with xyz</li>
<li><code>labelmatchpattern .*xyz.*</code> - Label must contain xyz</li>
<li><code>labelmatchpattern .*xyz</code> - Label must end with xyz</li>
<li><code>labelmatchpattern ^xyz$</code> - Label must extctly match xyz</li>
<li><code>sendermatchpattern &lt;REMatchPattern&gt;</code> - Only display messages if the sender matches the <code>&lt;REMatchPattern&gt;</code></li>
</ul>
<p>When <code>matchlabel &lt;LabelName&gt;</code> is specified, the following characters are replaced with a <code>-</code> in the generated query.</p>
<pre><code> &amp;()&quot;|{}/
</code></pre>
<p>By default, Gam fetches only <code>max_to_process</code> matching messages from Google and then displays them.
To see how many messages actually match, specify <code>notquick</code> and all matching messages will be fetched; only <code>max_to_process</code> of them will be displayed.</p>
<h3 id="difference-between-from-and-sender-headers">Difference between <code>From</code> and <code>Sender</code> headers</h3>
<p>The <code>From</code> header specifies the author of the message, that is,
the mailbox of the person or system responsible for the writing of the message.
The <code>Sender</code> header specifies the mailbox of the agent responsible
for the actual transmission of the message.  For example, if a secretary were to send
a message for another person, the mailbox of the secretary would appear in the
<code>Sender</code> header and the mailbox of the actual author would appear in the <code>From</code> header.</p>
<p>The Gmail API supports querying the <code>From</code> header, but not the <code>Sender</code> header;
thus, you must use <code>sendermatchpattern &lt;REMatchPattern&gt;</code> to query this header.</p>
<h2 id="choose-information-to-display">Choose information to display</h2>
<p>By default, the fields <code>User, threadId, id</code> and these SMTP headers are displayed: <code>Date, Subject, From, Reply-To, To, Delivered-To, Content-Type, Message-ID</code>.
Use these options to customize the display.</p>
<p>By default, the <code>&lt;SMTPDateHeader&gt;</code> values are displayed in RFC2822 format; the <code>dateheaderformat iso|rfc2822|&lt;String&gt;</code> option allows reformatting it:
* <code>iso</code> - Format is <code>%Y-%m-%dT%H:%M:%S%:z</code>
* <code>rfc2822</code> - Format is <code>%a, %d %b %Y %H:%M:%S %z</code>
* <code>&lt;String&gt;</code> - Format according to: https://docs.python.org/3/library/datetime.html#strftime-strptime-behavior
If the <code>Date</code> header value can't be parsed as RFC2822, it is left unchanged.</p>
<p>The <code>dateheaderconverttimezone [&lt;Boolean&gt;]&gt;</code> option converts <code>&lt;SMTPDateHeader&gt;</code> values to the <code>gam.cfg timezone</code>.</p>
<h3 id="display-message-content">Display message content</h3>
<ul>
<li><code>headers all</code> - Display all SMTP headers</li>
<li><code>headers &lt;SMTPHeaderList&gt;</code> - Display only the SMTP headers listed</li>
<li><code>showbody</code> - Display the message body</li>
<li><code>showhtml</code> - When used in conjunction with <code>showbody</code>, display the message body if it is of type <code>text/html</code></li>
<li><code>showdate</code> - Display the message <code>internalDate</code></li>
<li><code>showlabels</code> - Display the message labels and count</li>
<li><code>useronly</code> - Do not display system labels</li>
<li><code>delimiter &lt;Character&gt;</code> - Separate the list of labels with <code>&lt;Character&gt;</code>; the default value is <code>csv_output_field_delimiter</code> from <code>gam.cfg</code>.</li>
<li><code>showsize</code> - Display the message size</li>
<li><code>showsnippet</code> - Display the message snippet</li>
</ul>
<h3 id="display-message-counts">Display message counts</h3>
<ul>
<li><code>countsonly</code> - Display the count of the number of messages</li>
<li><code>showsize</code> - Display the cumulative message size</li>
</ul>
<h3 id="display-label-counts">Display label counts</h3>
<ul>
<li><code>showlabels</code> - Display the message labels</li>
<li><code>countsonly</code> - Display all message label counts</li>
<li><code>positivecountsonly</code> - Display message label counts that are greater than 0</li>
<li><code>showsize</code> - Display the cumulative message size for each label</li>
<li><code>useronly</code> - Do not display system labels</li>
</ul>
<h2 id="print-only-options">Print only options</h2>
<p>These options are valid with <code>print</code>.
* <code>convertcrnl</code> - In the message body, convert carriage returns to <code>\r</code> and newlines to <code>\n</code>; the default value is <code>csv_output_convert_cr_nl</code> from <code>gam.cfg</code>.
* <code>addcsvdata &lt;FieldName&gt; &lt;String&gt;</code> - Add additional columns of data from the command line to the output</p>
<p>By default, message attachment information is not displayed.
* <code>showattachments</code> - Display attachment filename, MIME type and size
* <code>attachmentnamepattern &lt;REMatchPattern&gt;&gt;</code> - Limit the attachments shown to those whose names match <code>&lt;REMatchPattern&gt;</code></p>
<h2 id="show-only-options">Show only options</h2>
<p>These options are valid with <code>show</code>.</p>
<p>By default, message attachment information is not displayed.
* <code>showattachments</code> - Display message attachment content for MIME type text/plain, display filename, MIME type and size for other MIME types
  * <code>noshowtextplain</code> - Do not display message attachment content for MIME type text/plain, just display its filename, MIME type and size
* <code>attachmentnamepattern &lt;REMatchPattern&gt;&gt;</code> - Limit the attachments shown to those whose names match <code>&lt;REMatchPattern&gt;</code></p>
<h2 id="download-attachments">Download attachments</h2>
<p>These options are valid with <code>show</code>.</p>
<p>By default, message attachments are not downloaded.
* <code>saveattachments</code> - Download message attachments
* <code>attachmentnamepattern &lt;REMatchPattern&gt;&gt;</code> - Limit the attachments downloaded to those whose names match <code>&lt;REMatchPattern&gt;</code></p>
<p>By default, message attachments are downloaded to the directory specified in <code>gam.cfg/drive_dir</code>.
* <code>targetfolder &lt;FilePath&gt;</code> - Specify an alternate location for the downloaded attachments</p>
<p>The strings <code>#email#</code>, <code>#user#</code> and <code>#username#</code> will be replaced by the the user's full emailaddress or just the name portion
in <code>targetfolder &lt;FilePath&gt;</code>.</p>
<p>By default, when downloading attachments, an existing local file will not be overwritten; a numeric prefix is added to the filename.
* <code>overwrite</code> - Overwite an existing file
* <code>overwrite true</code> - Overwite an existing file
* <code>overwrite false</code> - Do not overwite an existing file; add a numeric prefix and create a new file</p>
<h2 id="upload-attachments">Upload attachments</h2>
<p>These options are valid with <code>show</code>.</p>
<p>By default, message attachments are not uploaded to Google Drive.
* <code>uploadattachments</code> - Upload message attachments
* <code>attachmentnamepattern &lt;REMatchPattern&gt;&gt;</code> - Limit the attachments uploaded to those whose names match <code>&lt;REMatchPattern&gt;</code></p>
<p>By default, message attachments are uploaded to the root of the user's My Drive.
* <code>&lt;DriveFileParentAttributeh&gt;</code> - Specify an alternate location for the uploaded attachments</p>
<h2 id="display-messages-sent-by-delegates-for-delegator">Display messages sent by delegates for delegator</h2>
<p>Display messages sent by a particular delegate for a delegator; the message is
from the delegator but sent by the delegate.</p>
<pre><code>$ gam user delegator show messages query &quot;in:sent&quot; sendermatchpattern delegate1@domain.com headers from,to,sender
Getting all Messages for delegator@domain.com
Got 24 Messages...
User: delegator@domain.com, Show maximum of 24 Messages of 24 Total Messages
  Message: 17a63d9f459cb9be (2/24)
    From: Test Simple &lt;delegator@domain.com&gt;
    To: ross.scroggs@gmail.com
    Sender: delegate1@domain.com

$ gam user delegator show messages query &quot;in:sent&quot; sendermatchpattern delegate2@domain.com headers from,to,sender
Getting all Messages for delegator@domain.com
Got 24 Messages...
User: delegator@domain.com, Show maximum of 24 Messages of 24 Total Messages
  Message: 17a63dc2cb14ed1e (1/24)
    From: Test Simple &lt;delegator@domain.com&gt;
    To: ross.scroggs@gmail.com
    Sender: delegate2@domain.com

$ gam user delegator show messages query &quot;in:sent&quot; sendermatchpattern &quot;delegate.*@domain.com&quot; headers from,to,sender
Getting all Messages for delegator@domain.com
Got 24 Messages...
User: delegator@domain.com, Show maximum of 24 Messages of 24 Total Messages
  Message: 17a63dc2cb14ed1e (1/24)
    From: Test Simple &lt;delegator@domain.com&gt;
    To: ross.scroggs@gmail.com
    Sender: delegate2@domain.com
  Message: 17a63d9f459cb9be (2/24)
    From: Test Simple &lt;delegator@domain.com&gt;
    To: ross.scroggs@gmail.com
    Sender: delegate1@domain.com
</code></pre>
<p>Display number of messages sent by delegates for a delegator; only delegates
that sent messages will be displayed.</p>
<pre><code>$ gam csv ./SentByDelegates.csv user delegator print messages query &quot;in:sent&quot; sendermatchpattern &quot;.+&quot; countsonly 
Getting all Messages for delegator@domain.com
Got 24 Messages...
$ more SentByDelegates.csv
User,Sender,messages
delegator@domain.com,delegate1@domain.com,1
delegator@domain.com,delegate2@domain.com,1
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
